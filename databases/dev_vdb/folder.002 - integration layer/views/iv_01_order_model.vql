CREATE OR REPLACE VIEW iv_01_order_model FOLDER = '/002 - integration layer' AS SELECT bv_sqls_orderitem.id AS id, bv_sqls_product.productname AS productname, bv_sqls_product.package AS package, bv_sqls_product.isdiscontinued AS isdiscontinued, bv_sqls_orderitem.unitprice AS orderitem_unitprice, bv_sqls_orderitem.quantity AS quantity, (bv_sqls_orderitem.unitprice*bv_sqls_orderitem.quantity) AS total_price, bv_sqls_supplier.companyname AS companyname, bv_sqls_supplier.contactname AS contactname, bv_sqls_supplier.contacttitle AS contacttitle, bv_sqls_supplier.city AS supplier_city, bv_sqls_supplier.country AS supplier_country, bv_sqls_supplier.phone AS supplier_phone, bv_sqls_supplier.fax AS supplier_fax, bv_sqls_customer.firstname AS customer_firstname, bv_sqls_customer.lastname AS customer_lastname, bv_sqls_customer.city AS customer_city, bv_sqls_customer.country AS customer_country, bv_sqls_customer.phone AS customer_phone, addyear(orderdate, 5) AS orderdate, iv_01_ws_order_flattened.ordernumber AS ordernumber, iv_01_ws_order_flattened.totalamount AS totalamount FROM ((bv_sqls_orderitem AS bv_sqls_orderitem INNER JOIN bv_sqls_product AS bv_sqls_product ON bv_sqls_orderitem.productid = bv_sqls_product.id ) INNER JOIN bv_sqls_supplier AS bv_sqls_supplier ON bv_sqls_product.supplierid = bv_sqls_supplier.id ) INNER JOIN (iv_01_ws_order_flattened AS iv_01_ws_order_flattened INNER JOIN bv_sqls_customer AS bv_sqls_customer ON iv_01_ws_order_flattened.customerid = bv_sqls_customer.id ) ON bv_sqls_orderitem.orderid = iv_01_ws_order_flattened.id ;

ALTER VIEW iv_01_order_model
 LAYOUT (bv_sqls_orderitem = [0, 113, 200, 126], bv_sqls_product = [250, 186, 200, 146], bv_sqls_supplier = [500, 176, 200, 186], iv_01_ws_order_flattened = [250, 20, 200, 126], bv_sqls_customer = [500, 0, 200, 146]);

