CREATE OR REPLACE VIEW iv_02_order_model FOLDER = '/002 - integration layer' AS SELECT iv_01_order_model.id AS id, iv_01_order_model.productname AS productname, iv_01_order_model.package AS package, iv_01_order_model.isdiscontinued AS isdiscontinued, iv_01_order_model.orderitem_unitprice AS orderitem_unitprice, iv_01_order_model.quantity AS quantity, iv_01_order_model.total_price AS total_price, iv_01_order_model.companyname AS companyname, iv_01_order_model.contactname AS contactname, iv_01_order_model.contacttitle AS contacttitle, iv_01_order_model.supplier_city AS supplier_city, iv_01_order_model.supplier_country AS supplier_country, iv_01_order_model.supplier_phone AS supplier_phone, iv_01_order_model.supplier_fax AS supplier_fax, iv_01_order_model.orderdate AS orderdate, iv_01_order_model.ordernumber AS ordernumber, iv_01_order_model.totalamount AS totalamount, iv_01_order_model.customer_firstname AS customer_firstname, iv_01_order_model.customer_lastname AS customer_lastname, iv_01_order_model.customer_city AS customer_city, iv_01_order_model.customer_country AS customer_country, iv_01_order_model.customer_phone AS customer_phone, case WHEN (bv_sqls_randomdata_big.somebit is true ) THEN (somenumeric/bv_sqls_randomdata_big.someint) END AS calculation, bv_sqls_randomdata_big.someint AS someint, bv_sqls_randomdata_big.somevarchar AS somevarchar, bv_sqls_randomdata_big.somedatetime AS somedatetime, bv_sqls_randomdata_big.somenumeric AS somenumeric, case WHEN (addyear(bv_sqls_randomdata_big.somedatetime, 2) > cast('timestamp', now())) THEN 'new' ELSE 'old' END AS check_date FROM iv_01_order_model AS iv_01_order_model LEFT OUTER JOIN bv_sqls_randomdata_big AS bv_sqls_randomdata_big ON iv_01_order_model.id = bv_sqls_randomdata_big.rowid  CONTEXT (DATAMOVEMENTPLAN = iv_01_ws_order_flattened : JDBC ds_sqlexpress);

ALTER VIEW iv_02_order_model
 LAYOUT (iv_01_order_model = [20, 20, 200, 225], bv_sqls_randomdata_big = [350, 30, 200, 146]);

